{"dependencies":[{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _socketIoClient = require(_dependencyMap[0], \"socket.io-client\");\n  const API_BASE_URL = process.env.EXPO_PUBLIC_BACKEND_URL || '';\n  class SocketService {\n    socket = null;\n    tenantId = null;\n    onNewAlert = null;\n    onEventUpdated = null;\n    reconnectAttempts = 0;\n    maxReconnectAttempts = 5;\n    connect(tenantId, token) {\n      if (this.socket?.connected && this.tenantId === tenantId) {\n        console.log('[Socket] Already connected to tenant:', tenantId);\n        return;\n      }\n      this.disconnect();\n      this.tenantId = tenantId;\n      console.log('[Socket] Connecting to:', `${API_BASE_URL}/api/socket.io`);\n      this.socket = (0, _socketIoClient.io)(API_BASE_URL, {\n        path: '/api/socket.io',\n        transports: ['websocket', 'polling'],\n        auth: {\n          token\n        },\n        reconnection: true,\n        reconnectionAttempts: this.maxReconnectAttempts,\n        reconnectionDelay: 1000,\n        reconnectionDelayMax: 5000\n      });\n      this.setupEventListeners();\n    }\n    setupEventListeners() {\n      if (!this.socket) return;\n      this.socket.on('connect', () => {\n        console.log('[Socket] Connected');\n        this.reconnectAttempts = 0;\n        // Join tenant room\n        if (this.tenantId) {\n          this.socket?.emit('join_tenant', {\n            tenant_id: this.tenantId\n          });\n        }\n      });\n      this.socket.on('disconnect', reason => {\n        console.log('[Socket] Disconnected:', reason);\n      });\n      this.socket.on('connect_error', error => {\n        console.error('[Socket] Connection error:', error.message);\n        this.reconnectAttempts++;\n      });\n      this.socket.on('joined', data => {\n        console.log('[Socket] Joined room:', data);\n      });\n\n      // Listen for new events\n      this.socket.on('new_event', data => {\n        console.log('[Socket] New event received:', data.event?.id);\n        if (this.onNewAlert && data.event) {\n          // Only notify for FALL events (critical alerts)\n          if (data.event.type === 'FALL' || data.event.type === 'PRE_FALL') {\n            this.onNewAlert(data.event);\n          }\n        }\n      });\n      this.socket.on('new_radar_event', data => {\n        console.log('[Socket] New radar event received:', data.event?.id);\n        if (this.onNewAlert && data.event) {\n          if (data.event.type === 'FALL' || data.event.type === 'PRE_FALL') {\n            this.onNewAlert(data.event);\n          }\n        }\n      });\n\n      // Listen for event updates\n      this.socket.on('event_updated', data => {\n        console.log('[Socket] Event updated:', data.event_id);\n        if (this.onEventUpdated) {\n          this.onEventUpdated(data);\n        }\n      });\n    }\n    disconnect() {\n      if (this.socket) {\n        if (this.tenantId) {\n          this.socket.emit('leave_tenant', {\n            tenant_id: this.tenantId\n          });\n        }\n        this.socket.disconnect();\n        this.socket = null;\n      }\n      this.tenantId = null;\n    }\n    setOnNewAlert(callback) {\n      this.onNewAlert = callback;\n    }\n    setOnEventUpdated(callback) {\n      this.onEventUpdated = callback;\n    }\n    isConnected() {\n      return this.socket?.connected ?? false;\n    }\n  }\n  const socketService = new SocketService();\n  var _default = socketService;\n});","lineCount":123,"map":[[7,2,117,0,"Object"],[7,8,117,0],[7,9,117,0,"defineProperty"],[7,23,117,0],[7,24,117,0,"exports"],[7,31,117,0],[8,4,117,0,"enumerable"],[8,14,117,0],[9,4,117,0,"get"],[9,7,117,0],[9,18,117,0,"get"],[9,19,117,0],[10,6,117,0],[10,13,117,0,"_default"],[10,21,117,0],[11,4,117,0],[12,2,117,0],[13,2,116,0,"Object"],[13,8,116,0],[13,9,116,0,"defineProperty"],[13,23,116,0],[13,24,116,0,"exports"],[13,31,116,0],[14,4,116,0,"enumerable"],[14,14,116,0],[15,4,116,0,"get"],[15,7,116,0],[15,18,116,0,"get"],[15,19,116,0],[16,6,116,0],[16,13,116,0,"socketService"],[16,26,116,0],[17,4,116,0],[18,2,116,0],[19,2,1,0],[19,6,1,0,"_socketIoClient"],[19,21,1,0],[19,24,1,0,"require"],[19,31,1,0],[19,32,1,0,"_dependencyMap"],[19,46,1,0],[20,2,4,0],[20,8,4,6,"API_BASE_URL"],[20,20,4,18],[20,23,4,21,"process"],[20,30,4,28],[20,31,4,29,"env"],[20,34,4,32],[20,35,4,33,"EXPO_PUBLIC_BACKEND_URL"],[20,58,4,56],[20,62,4,60],[20,64,4,62],[21,2,6,0],[21,8,6,6,"SocketService"],[21,21,6,19],[21,22,6,20],[22,4,7,10,"socket"],[22,10,7,16],[22,13,7,34],[22,17,7,38],[23,4,8,10,"tenantId"],[23,12,8,18],[23,15,8,36],[23,19,8,40],[24,4,9,10,"onNewAlert"],[24,14,9,20],[24,17,9,56],[24,21,9,60],[25,4,10,10,"onEventUpdated"],[25,18,10,24],[25,21,10,87],[25,25,10,91],[26,4,11,10,"reconnectAttempts"],[26,21,11,27],[26,24,11,30],[26,25,11,31],[27,4,12,10,"maxReconnectAttempts"],[27,24,12,30],[27,27,12,33],[27,28,12,34],[28,4,14,2,"connect"],[28,11,14,9,"connect"],[28,12,14,10,"tenantId"],[28,20,14,26],[28,22,14,28,"token"],[28,27,14,41],[28,29,14,49],[29,6,15,4],[29,10,15,8],[29,14,15,12],[29,15,15,13,"socket"],[29,21,15,19],[29,23,15,21,"connected"],[29,32,15,30],[29,36,15,34],[29,40,15,38],[29,41,15,39,"tenantId"],[29,49,15,47],[29,54,15,52,"tenantId"],[29,62,15,60],[29,64,15,62],[30,8,16,6,"console"],[30,15,16,13],[30,16,16,14,"log"],[30,19,16,17],[30,20,16,18],[30,59,16,57],[30,61,16,59,"tenantId"],[30,69,16,67],[30,70,16,68],[31,8,17,6],[32,6,18,4],[33,6,20,4],[33,10,20,8],[33,11,20,9,"disconnect"],[33,21,20,19],[33,22,20,20],[33,23,20,21],[34,6,21,4],[34,10,21,8],[34,11,21,9,"tenantId"],[34,19,21,17],[34,22,21,20,"tenantId"],[34,30,21,28],[35,6,23,4,"console"],[35,13,23,11],[35,14,23,12,"log"],[35,17,23,15],[35,18,23,16],[35,43,23,41],[35,45,23,43],[35,48,23,46,"API_BASE_URL"],[35,60,23,58],[35,76,23,74],[35,77,23,75],[36,6,25,4],[36,10,25,8],[36,11,25,9,"socket"],[36,17,25,15],[36,20,25,18],[36,24,25,18,"io"],[36,39,25,20],[36,40,25,20,"io"],[36,42,25,20],[36,44,25,21,"API_BASE_URL"],[36,56,25,33],[36,58,25,35],[37,8,26,6,"path"],[37,12,26,10],[37,14,26,12],[37,30,26,28],[38,8,27,6,"transports"],[38,18,27,16],[38,20,27,18],[38,21,27,19],[38,32,27,30],[38,34,27,32],[38,43,27,41],[38,44,27,42],[39,8,28,6,"auth"],[39,12,28,10],[39,14,28,12],[40,10,28,14,"token"],[41,8,28,20],[41,9,28,21],[42,8,29,6,"reconnection"],[42,20,29,18],[42,22,29,20],[42,26,29,24],[43,8,30,6,"reconnectionAttempts"],[43,28,30,26],[43,30,30,28],[43,34,30,32],[43,35,30,33,"maxReconnectAttempts"],[43,55,30,53],[44,8,31,6,"reconnectionDelay"],[44,25,31,23],[44,27,31,25],[44,31,31,29],[45,8,32,6,"reconnectionDelayMax"],[45,28,32,26],[45,30,32,28],[46,6,33,4],[46,7,33,5],[46,8,33,6],[47,6,35,4],[47,10,35,8],[47,11,35,9,"setupEventListeners"],[47,30,35,28],[47,31,35,29],[47,32,35,30],[48,4,36,2],[49,4,38,10,"setupEventListeners"],[49,23,38,29,"setupEventListeners"],[49,24,38,29],[49,26,38,38],[50,6,39,4],[50,10,39,8],[50,11,39,9],[50,15,39,13],[50,16,39,14,"socket"],[50,22,39,20],[50,24,39,22],[51,6,41,4],[51,10,41,8],[51,11,41,9,"socket"],[51,17,41,15],[51,18,41,16,"on"],[51,20,41,18],[51,21,41,19],[51,30,41,28],[51,32,41,30],[51,38,41,36],[52,8,42,6,"console"],[52,15,42,13],[52,16,42,14,"log"],[52,19,42,17],[52,20,42,18],[52,40,42,38],[52,41,42,39],[53,8,43,6],[53,12,43,10],[53,13,43,11,"reconnectAttempts"],[53,30,43,28],[53,33,43,31],[53,34,43,32],[54,8,44,6],[55,8,45,6],[55,12,45,10],[55,16,45,14],[55,17,45,15,"tenantId"],[55,25,45,23],[55,27,45,25],[56,10,46,8],[56,14,46,12],[56,15,46,13,"socket"],[56,21,46,19],[56,23,46,21,"emit"],[56,27,46,25],[56,28,46,26],[56,41,46,39],[56,43,46,41],[57,12,46,43,"tenant_id"],[57,21,46,52],[57,23,46,54],[57,27,46,58],[57,28,46,59,"tenantId"],[58,10,46,68],[58,11,46,69],[58,12,46,70],[59,8,47,6],[60,6,48,4],[60,7,48,5],[60,8,48,6],[61,6,50,4],[61,10,50,8],[61,11,50,9,"socket"],[61,17,50,15],[61,18,50,16,"on"],[61,20,50,18],[61,21,50,19],[61,33,50,31],[61,35,50,34,"reason"],[61,41,50,40],[61,45,50,45],[62,8,51,6,"console"],[62,15,51,13],[62,16,51,14,"log"],[62,19,51,17],[62,20,51,18],[62,44,51,42],[62,46,51,44,"reason"],[62,52,51,50],[62,53,51,51],[63,6,52,4],[63,7,52,5],[63,8,52,6],[64,6,54,4],[64,10,54,8],[64,11,54,9,"socket"],[64,17,54,15],[64,18,54,16,"on"],[64,20,54,18],[64,21,54,19],[64,36,54,34],[64,38,54,37,"error"],[64,43,54,42],[64,47,54,47],[65,8,55,6,"console"],[65,15,55,13],[65,16,55,14,"error"],[65,21,55,19],[65,22,55,20],[65,50,55,48],[65,52,55,50,"error"],[65,57,55,55],[65,58,55,56,"message"],[65,65,55,63],[65,66,55,64],[66,8,56,6],[66,12,56,10],[66,13,56,11,"reconnectAttempts"],[66,30,56,28],[66,32,56,30],[67,6,57,4],[67,7,57,5],[67,8,57,6],[68,6,59,4],[68,10,59,8],[68,11,59,9,"socket"],[68,17,59,15],[68,18,59,16,"on"],[68,20,59,18],[68,21,59,19],[68,29,59,27],[68,31,59,30,"data"],[68,35,59,34],[68,39,59,39],[69,8,60,6,"console"],[69,15,60,13],[69,16,60,14,"log"],[69,19,60,17],[69,20,60,18],[69,43,60,41],[69,45,60,43,"data"],[69,49,60,47],[69,50,60,48],[70,6,61,4],[70,7,61,5],[70,8,61,6],[72,6,63,4],[73,6,64,4],[73,10,64,8],[73,11,64,9,"socket"],[73,17,64,15],[73,18,64,16,"on"],[73,20,64,18],[73,21,64,19],[73,32,64,30],[73,34,64,33,"data"],[73,38,64,69],[73,42,64,74],[74,8,65,6,"console"],[74,15,65,13],[74,16,65,14,"log"],[74,19,65,17],[74,20,65,18],[74,50,65,48],[74,52,65,50,"data"],[74,56,65,54],[74,57,65,55,"event"],[74,62,65,60],[74,64,65,62,"id"],[74,66,65,64],[74,67,65,65],[75,8,66,6],[75,12,66,10],[75,16,66,14],[75,17,66,15,"onNewAlert"],[75,27,66,25],[75,31,66,29,"data"],[75,35,66,33],[75,36,66,34,"event"],[75,41,66,39],[75,43,66,41],[76,10,67,8],[77,10,68,8],[77,14,68,12,"data"],[77,18,68,16],[77,19,68,17,"event"],[77,24,68,22],[77,25,68,23,"type"],[77,29,68,27],[77,34,68,32],[77,40,68,38],[77,44,68,42,"data"],[77,48,68,46],[77,49,68,47,"event"],[77,54,68,52],[77,55,68,53,"type"],[77,59,68,57],[77,64,68,62],[77,74,68,72],[77,76,68,74],[78,12,69,10],[78,16,69,14],[78,17,69,15,"onNewAlert"],[78,27,69,25],[78,28,69,26,"data"],[78,32,69,30],[78,33,69,31,"event"],[78,38,69,36],[78,39,69,37],[79,10,70,8],[80,8,71,6],[81,6,72,4],[81,7,72,5],[81,8,72,6],[82,6,74,4],[82,10,74,8],[82,11,74,9,"socket"],[82,17,74,15],[82,18,74,16,"on"],[82,20,74,18],[82,21,74,19],[82,38,74,36],[82,40,74,39,"data"],[82,44,74,75],[82,48,74,80],[83,8,75,6,"console"],[83,15,75,13],[83,16,75,14,"log"],[83,19,75,17],[83,20,75,18],[83,56,75,54],[83,58,75,56,"data"],[83,62,75,60],[83,63,75,61,"event"],[83,68,75,66],[83,70,75,68,"id"],[83,72,75,70],[83,73,75,71],[84,8,76,6],[84,12,76,10],[84,16,76,14],[84,17,76,15,"onNewAlert"],[84,27,76,25],[84,31,76,29,"data"],[84,35,76,33],[84,36,76,34,"event"],[84,41,76,39],[84,43,76,41],[85,10,77,8],[85,14,77,12,"data"],[85,18,77,16],[85,19,77,17,"event"],[85,24,77,22],[85,25,77,23,"type"],[85,29,77,27],[85,34,77,32],[85,40,77,38],[85,44,77,42,"data"],[85,48,77,46],[85,49,77,47,"event"],[85,54,77,52],[85,55,77,53,"type"],[85,59,77,57],[85,64,77,62],[85,74,77,72],[85,76,77,74],[86,12,78,10],[86,16,78,14],[86,17,78,15,"onNewAlert"],[86,27,78,25],[86,28,78,26,"data"],[86,32,78,30],[86,33,78,31,"event"],[86,38,78,36],[86,39,78,37],[87,10,79,8],[88,8,80,6],[89,6,81,4],[89,7,81,5],[89,8,81,6],[91,6,83,4],[92,6,84,4],[92,10,84,8],[92,11,84,9,"socket"],[92,17,84,15],[92,18,84,16,"on"],[92,20,84,18],[92,21,84,19],[92,36,84,34],[92,38,84,37,"data"],[92,42,84,90],[92,46,84,95],[93,8,85,6,"console"],[93,15,85,13],[93,16,85,14,"log"],[93,19,85,17],[93,20,85,18],[93,45,85,43],[93,47,85,45,"data"],[93,51,85,49],[93,52,85,50,"event_id"],[93,60,85,58],[93,61,85,59],[94,8,86,6],[94,12,86,10],[94,16,86,14],[94,17,86,15,"onEventUpdated"],[94,31,86,29],[94,33,86,31],[95,10,87,8],[95,14,87,12],[95,15,87,13,"onEventUpdated"],[95,29,87,27],[95,30,87,28,"data"],[95,34,87,32],[95,35,87,33],[96,8,88,6],[97,6,89,4],[97,7,89,5],[97,8,89,6],[98,4,90,2],[99,4,92,2,"disconnect"],[99,14,92,12,"disconnect"],[99,15,92,12],[99,17,92,21],[100,6,93,4],[100,10,93,8],[100,14,93,12],[100,15,93,13,"socket"],[100,21,93,19],[100,23,93,21],[101,8,94,6],[101,12,94,10],[101,16,94,14],[101,17,94,15,"tenantId"],[101,25,94,23],[101,27,94,25],[102,10,95,8],[102,14,95,12],[102,15,95,13,"socket"],[102,21,95,19],[102,22,95,20,"emit"],[102,26,95,24],[102,27,95,25],[102,41,95,39],[102,43,95,41],[103,12,95,43,"tenant_id"],[103,21,95,52],[103,23,95,54],[103,27,95,58],[103,28,95,59,"tenantId"],[104,10,95,68],[104,11,95,69],[104,12,95,70],[105,8,96,6],[106,8,97,6],[106,12,97,10],[106,13,97,11,"socket"],[106,19,97,17],[106,20,97,18,"disconnect"],[106,30,97,28],[106,31,97,29],[106,32,97,30],[107,8,98,6],[107,12,98,10],[107,13,98,11,"socket"],[107,19,98,17],[107,22,98,20],[107,26,98,24],[108,6,99,4],[109,6,100,4],[109,10,100,8],[109,11,100,9,"tenantId"],[109,19,100,17],[109,22,100,20],[109,26,100,24],[110,4,101,2],[111,4,103,2,"setOnNewAlert"],[111,17,103,15,"setOnNewAlert"],[111,18,103,16,"callback"],[111,26,103,57],[111,28,103,65],[112,6,104,4],[112,10,104,8],[112,11,104,9,"onNewAlert"],[112,21,104,19],[112,24,104,22,"callback"],[112,32,104,30],[113,4,105,2],[114,4,107,2,"setOnEventUpdated"],[114,21,107,19,"setOnEventUpdated"],[114,22,107,20,"callback"],[114,30,107,88],[114,32,107,96],[115,6,108,4],[115,10,108,8],[115,11,108,9,"onEventUpdated"],[115,25,108,23],[115,28,108,26,"callback"],[115,36,108,34],[116,4,109,2],[117,4,111,2,"isConnected"],[117,15,111,13,"isConnected"],[117,16,111,13],[117,18,111,25],[118,6,112,4],[118,13,112,11],[118,17,112,15],[118,18,112,16,"socket"],[118,24,112,22],[118,26,112,24,"connected"],[118,35,112,33],[118,39,112,37],[118,44,112,42],[119,4,113,2],[120,2,114,0],[121,2,116,7],[121,8,116,13,"socketService"],[121,21,116,26],[121,24,116,29],[121,28,116,33,"SocketService"],[121,41,116,46],[121,42,116,47],[121,43,116,48],[122,2,117,0],[122,6,117,0,"_default"],[122,14,117,0],[122,17,117,15,"socketService"],[122,30,117,28],[123,0,117,29],[123,3]],"functionMap":{"names":["<global>","SocketService","SocketService#connect","SocketService#setupEventListeners","on$argument_1","SocketService#disconnect","SocketService#setOnNewAlert","SocketService#setOnEventUpdated","SocketService#isConnected"],"mappings":"AAA;ACK;ECQ;GDsB;EEE;8BCG;KDO;iCCE;KDE;oCCE;KDG;6BCE;KDE;gCCG;KDQ;sCCE;KDO;oCCG;KDK;GFC;EIE;GJS;EKE;GLE;EME;GNE;EOE;GPE;CDC"},"hasCjsExports":false},"type":"js/module"}]}