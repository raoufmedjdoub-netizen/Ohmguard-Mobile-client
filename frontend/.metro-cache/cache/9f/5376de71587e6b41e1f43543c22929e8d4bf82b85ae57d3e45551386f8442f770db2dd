{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":67},"end":{"line":3,"column":56,"index":123}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"../services/socket","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":124},"end":{"line":4,"column":47,"index":171}}],"key":"Zr9DRnwDVZxHFeGDyPwyujLo6pk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _servicesApi = require(_dependencyMap[1], \"../services/api\");\n  var _servicesSocket = require(_dependencyMap[2], \"../services/socket\");\n  var socketService = _interopDefault(_servicesSocket);\n  const useAuthStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isAuthenticated: false,\n    isLoading: true,\n    error: null,\n    login: async (email, password) => {\n      set({\n        isLoading: true,\n        error: null\n      });\n      try {\n        await _servicesApi.authApi.login({\n          email,\n          password\n        });\n        const user = await _servicesApi.authApi.getCurrentUser();\n\n        // Connect to WebSocket\n        const token = await _servicesApi.tokenManager.getAccessToken();\n        if (user.tenant_id && token) {\n          socketService.default.connect(user.tenant_id, token);\n        }\n        set({\n          user,\n          isAuthenticated: true,\n          isLoading: false\n        });\n        return true;\n      } catch (error) {\n        const message = error.response?.data?.detail || 'Erreur de connexion';\n        set({\n          error: message,\n          isLoading: false\n        });\n        return false;\n      }\n    },\n    logout: async () => {\n      socketService.default.disconnect();\n      await _servicesApi.authApi.logout();\n      set({\n        user: null,\n        isAuthenticated: false,\n        error: null\n      });\n    },\n    checkAuth: async () => {\n      set({\n        isLoading: true\n      });\n      try {\n        const token = await _servicesApi.tokenManager.getAccessToken();\n        if (!token) {\n          set({\n            isLoading: false,\n            isAuthenticated: false\n          });\n          return false;\n        }\n        const user = await _servicesApi.authApi.getCurrentUser();\n\n        // Connect to WebSocket\n        if (user.tenant_id) {\n          socketService.default.connect(user.tenant_id, token);\n        }\n        set({\n          user,\n          isAuthenticated: true,\n          isLoading: false\n        });\n        return true;\n      } catch (error) {\n        await _servicesApi.tokenManager.clearTokens();\n        set({\n          user: null,\n          isAuthenticated: false,\n          isLoading: false\n        });\n        return false;\n      }\n    },\n    clearError: () => set({\n      error: null\n    })\n  }));\n});","lineCount":107,"map":[[12,2,19,0,"Object"],[12,8,19,0],[12,9,19,0,"defineProperty"],[12,23,19,0],[12,24,19,0,"exports"],[12,31,19,0],[13,4,19,0,"enumerable"],[13,14,19,0],[14,4,19,0,"get"],[14,7,19,0],[14,18,19,0,"get"],[14,19,19,0],[15,6,19,0],[15,13,19,0,"useAuthStore"],[15,25,19,0],[16,4,19,0],[17,2,19,0],[18,2,1,0],[18,6,1,0,"_zustand"],[18,14,1,0],[18,17,1,0,"require"],[18,24,1,0],[18,25,1,0,"_dependencyMap"],[18,39,1,0],[19,2,3,0],[19,6,3,0,"_servicesApi"],[19,18,3,0],[19,21,3,0,"require"],[19,28,3,0],[19,29,3,0,"_dependencyMap"],[19,43,3,0],[20,2,4,0],[20,6,4,0,"_servicesSocket"],[20,21,4,0],[20,24,4,0,"require"],[20,31,4,0],[20,32,4,0,"_dependencyMap"],[20,46,4,0],[21,2,4,0],[21,6,4,0,"socketService"],[21,19,4,0],[21,22,4,0,"_interopDefault"],[21,37,4,0],[21,38,4,0,"_servicesSocket"],[21,53,4,0],[22,2,19,7],[22,8,19,13,"useAuthStore"],[22,20,19,25],[22,23,19,28],[22,27,19,28,"create"],[22,35,19,34],[22,36,19,34,"create"],[22,42,19,34],[22,44,19,46],[22,45,19,47,"set"],[22,48,19,50],[22,50,19,52,"get"],[22,53,19,55],[22,59,19,61],[23,4,20,2,"user"],[23,8,20,6],[23,10,20,8],[23,14,20,12],[24,4,21,2,"isAuthenticated"],[24,19,21,17],[24,21,21,19],[24,26,21,24],[25,4,22,2,"isLoading"],[25,13,22,11],[25,15,22,13],[25,19,22,17],[26,4,23,2,"error"],[26,9,23,7],[26,11,23,9],[26,15,23,13],[27,4,25,2,"login"],[27,9,25,7],[27,11,25,9],[27,17,25,9,"login"],[27,18,25,16,"email"],[27,23,25,29],[27,25,25,31,"password"],[27,33,25,47],[27,38,25,70],[28,6,26,4,"set"],[28,9,26,7],[28,10,26,8],[29,8,26,10,"isLoading"],[29,17,26,19],[29,19,26,21],[29,23,26,25],[30,8,26,27,"error"],[30,13,26,32],[30,15,26,34],[31,6,26,39],[31,7,26,40],[31,8,26,41],[32,6,27,4],[32,10,27,8],[33,8,28,6],[33,14,28,12,"authApi"],[33,26,28,19],[33,27,28,19,"authApi"],[33,34,28,19],[33,35,28,20,"login"],[33,40,28,25],[33,41,28,26],[34,10,28,28,"email"],[34,15,28,33],[35,10,28,35,"password"],[36,8,28,44],[36,9,28,45],[36,10,28,46],[37,8,29,6],[37,14,29,12,"user"],[37,18,29,16],[37,21,29,19],[37,27,29,25,"authApi"],[37,39,29,32],[37,40,29,32,"authApi"],[37,47,29,32],[37,48,29,33,"getCurrentUser"],[37,62,29,47],[37,63,29,48],[37,64,29,49],[39,8,31,6],[40,8,32,6],[40,14,32,12,"token"],[40,19,32,17],[40,22,32,20],[40,28,32,26,"tokenManager"],[40,40,32,38],[40,41,32,38,"tokenManager"],[40,53,32,38],[40,54,32,39,"getAccessToken"],[40,68,32,53],[40,69,32,54],[40,70,32,55],[41,8,33,6],[41,12,33,10,"user"],[41,16,33,14],[41,17,33,15,"tenant_id"],[41,26,33,24],[41,30,33,28,"token"],[41,35,33,33],[41,37,33,35],[42,10,34,8,"socketService"],[42,23,34,21],[42,24,34,21,"default"],[42,31,34,21],[42,32,34,22,"connect"],[42,39,34,29],[42,40,34,30,"user"],[42,44,34,34],[42,45,34,35,"tenant_id"],[42,54,34,44],[42,56,34,46,"token"],[42,61,34,51],[42,62,34,52],[43,8,35,6],[44,8,37,6,"set"],[44,11,37,9],[44,12,37,10],[45,10,37,12,"user"],[45,14,37,16],[46,10,37,18,"isAuthenticated"],[46,25,37,33],[46,27,37,35],[46,31,37,39],[47,10,37,41,"isLoading"],[47,19,37,50],[47,21,37,52],[48,8,37,58],[48,9,37,59],[48,10,37,60],[49,8,38,6],[49,15,38,13],[49,19,38,17],[50,6,39,4],[50,7,39,5],[50,8,39,6],[50,15,39,13,"error"],[50,20,39,23],[50,22,39,25],[51,8,40,6],[51,14,40,12,"message"],[51,21,40,19],[51,24,40,22,"error"],[51,29,40,27],[51,30,40,28,"response"],[51,38,40,36],[51,40,40,38,"data"],[51,44,40,42],[51,46,40,44,"detail"],[51,52,40,50],[51,56,40,54],[51,77,40,75],[52,8,41,6,"set"],[52,11,41,9],[52,12,41,10],[53,10,41,12,"error"],[53,15,41,17],[53,17,41,19,"message"],[53,24,41,26],[54,10,41,28,"isLoading"],[54,19,41,37],[54,21,41,39],[55,8,41,45],[55,9,41,46],[55,10,41,47],[56,8,42,6],[56,15,42,13],[56,20,42,18],[57,6,43,4],[58,4,44,2],[58,5,44,3],[59,4,46,2,"logout"],[59,10,46,8],[59,12,46,10],[59,18,46,10,"logout"],[59,19,46,10],[59,24,46,37],[60,6,47,4,"socketService"],[60,19,47,17],[60,20,47,17,"default"],[60,27,47,17],[60,28,47,18,"disconnect"],[60,38,47,28],[60,39,47,29],[60,40,47,30],[61,6,48,4],[61,12,48,10,"authApi"],[61,24,48,17],[61,25,48,17,"authApi"],[61,32,48,17],[61,33,48,18,"logout"],[61,39,48,24],[61,40,48,25],[61,41,48,26],[62,6,49,4,"set"],[62,9,49,7],[62,10,49,8],[63,8,49,10,"user"],[63,12,49,14],[63,14,49,16],[63,18,49,20],[64,8,49,22,"isAuthenticated"],[64,23,49,37],[64,25,49,39],[64,30,49,44],[65,8,49,46,"error"],[65,13,49,51],[65,15,49,53],[66,6,49,58],[66,7,49,59],[66,8,49,60],[67,4,50,2],[67,5,50,3],[68,4,52,2,"checkAuth"],[68,13,52,11],[68,15,52,13],[68,21,52,13,"checkAuth"],[68,22,52,13],[68,27,52,43],[69,6,53,4,"set"],[69,9,53,7],[69,10,53,8],[70,8,53,10,"isLoading"],[70,17,53,19],[70,19,53,21],[71,6,53,26],[71,7,53,27],[71,8,53,28],[72,6,54,4],[72,10,54,8],[73,8,55,6],[73,14,55,12,"token"],[73,19,55,17],[73,22,55,20],[73,28,55,26,"tokenManager"],[73,40,55,38],[73,41,55,38,"tokenManager"],[73,53,55,38],[73,54,55,39,"getAccessToken"],[73,68,55,53],[73,69,55,54],[73,70,55,55],[74,8,56,6],[74,12,56,10],[74,13,56,11,"token"],[74,18,56,16],[74,20,56,18],[75,10,57,8,"set"],[75,13,57,11],[75,14,57,12],[76,12,57,14,"isLoading"],[76,21,57,23],[76,23,57,25],[76,28,57,30],[77,12,57,32,"isAuthenticated"],[77,27,57,47],[77,29,57,49],[78,10,57,55],[78,11,57,56],[78,12,57,57],[79,10,58,8],[79,17,58,15],[79,22,58,20],[80,8,59,6],[81,8,61,6],[81,14,61,12,"user"],[81,18,61,16],[81,21,61,19],[81,27,61,25,"authApi"],[81,39,61,32],[81,40,61,32,"authApi"],[81,47,61,32],[81,48,61,33,"getCurrentUser"],[81,62,61,47],[81,63,61,48],[81,64,61,49],[83,8,63,6],[84,8,64,6],[84,12,64,10,"user"],[84,16,64,14],[84,17,64,15,"tenant_id"],[84,26,64,24],[84,28,64,26],[85,10,65,8,"socketService"],[85,23,65,21],[85,24,65,21,"default"],[85,31,65,21],[85,32,65,22,"connect"],[85,39,65,29],[85,40,65,30,"user"],[85,44,65,34],[85,45,65,35,"tenant_id"],[85,54,65,44],[85,56,65,46,"token"],[85,61,65,51],[85,62,65,52],[86,8,66,6],[87,8,68,6,"set"],[87,11,68,9],[87,12,68,10],[88,10,68,12,"user"],[88,14,68,16],[89,10,68,18,"isAuthenticated"],[89,25,68,33],[89,27,68,35],[89,31,68,39],[90,10,68,41,"isLoading"],[90,19,68,50],[90,21,68,52],[91,8,68,58],[91,9,68,59],[91,10,68,60],[92,8,69,6],[92,15,69,13],[92,19,69,17],[93,6,70,4],[93,7,70,5],[93,8,70,6],[93,15,70,13,"error"],[93,20,70,18],[93,22,70,20],[94,8,71,6],[94,14,71,12,"tokenManager"],[94,26,71,24],[94,27,71,24,"tokenManager"],[94,39,71,24],[94,40,71,25,"clearTokens"],[94,51,71,36],[94,52,71,37],[94,53,71,38],[95,8,72,6,"set"],[95,11,72,9],[95,12,72,10],[96,10,72,12,"user"],[96,14,72,16],[96,16,72,18],[96,20,72,22],[97,10,72,24,"isAuthenticated"],[97,25,72,39],[97,27,72,41],[97,32,72,46],[98,10,72,48,"isLoading"],[98,19,72,57],[98,21,72,59],[99,8,72,65],[99,9,72,66],[99,10,72,67],[100,8,73,6],[100,15,73,13],[100,20,73,18],[101,6,74,4],[102,4,75,2],[102,5,75,3],[103,4,77,2,"clearError"],[103,14,77,12],[103,16,77,14,"clearError"],[103,17,77,14],[103,22,77,20,"set"],[103,25,77,23],[103,26,77,24],[104,6,77,26,"error"],[104,11,77,31],[104,13,77,33],[105,4,77,38],[105,5,77,39],[106,2,78,0],[106,3,78,1],[106,4,78,2],[106,5,78,3],[107,0,78,4],[107,3]],"functionMap":{"names":["<global>","create$argument_0","login","logout","checkAuth","clearError"],"mappings":"AAA;8CCkB;SCM;GDmB;UEE;GFI;aGE;GHuB;cIE,0BJ;EDC"},"hasCjsExports":false},"type":"js/module"}]}